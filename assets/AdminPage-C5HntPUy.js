import{d as b,u as F,a as q,j as e}from"./index-D_RnetDy.js";import{a as m,P,h as M,i as R}from"./lucide-react-Cx0r66_4.js";import{a as L,u as V}from"./useContestants-S_CvOsGv.js";import{c as T,d as C,e as z,u as G,f as I}from"./firebase-JdEOCa9W.js";const O=()=>{const[g,n]=m.useState(!1),[d,s]=m.useState(null),o=T(b,"contestants");return{addContestant:async i=>{n(!0),s(null);try{return await I(o,i),n(!1),!0}catch(l){return s(l.message),n(!1),!1}},updateContestant:async(i,l)=>{n(!0),s(null);try{const u=C(b,"contestants",i);return await G(u,l),n(!1),!0}catch(u){return s(u.message),n(!1),!1}},deleteContestant:async i=>{n(!0),s(null);try{const l=C(b,"contestants",i);return await z(l),n(!1),!0}catch(l){return s(l.message),n(!1),!1}},loading:g,error:d}},J=()=>{const{logout:g}=F(),n=q(),{contestants:d,loading:s,error:o}=L(),{addContestant:N,updateContestant:v,deleteContestant:w,loading:i,error:l}=O(),{voteData:u}=V(),[f,j]=m.useState(!1),[a,y]=m.useState(null),[r,p]=m.useState({name:"",age:0,photo:"",description:"",category:"miss",votes:0});m.useEffect(()=>{a?(p({name:a.name,age:a.age,photo:a.photo,description:a.description,category:a.category,votes:a.votes}),j(!0)):p({name:"",age:0,photo:"",description:"",category:"miss",votes:0})},[a]);const D=async()=>{try{await g(),n("/login")}catch(t){console.error("Error logging out:",t)}},h=t=>{const{name:c,value:x}=t.target;p(S=>({...S,[c]:c==="age"?parseInt(x):x}))},A=async t=>{t.preventDefault();const c={name:r.name,age:r.age,photo:r.photo,description:r.description,category:r.category,votes:r.votes};a?(await v(a.id,c),y(null)):await N(c),j(!1),p({name:"",age:0,photo:"",description:"",category:"miss",votes:0})},k=t=>{y(t)},E=async t=>{window.confirm("Êtes-vous sûr de vouloir supprimer ce candidat ?")&&await w(t)};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 via-pink-50 to-blue-50 p-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto bg-white p-8 rounded-lg shadow-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Page Administrateur"}),e.jsx("button",{onClick:D,className:"bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",children:"Déconnexion"})]}),i&&e.jsx("p",{className:"text-blue-600",children:"Opération en cours..."}),l&&e.jsxs("p",{className:"text-red-600",children:["Erreur: ",l]}),e.jsxs("div",{className:"mt-8 p-6 border rounded-lg bg-gray-50",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Gestion des candidats"}),e.jsxs("button",{onClick:()=>{j(!f),y(null)},className:"bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline flex items-center space-x-2 mb-6",children:[e.jsx(P,{className:"h-5 w-5"}),e.jsx("span",{children:f?"Annuler":"Ajouter un nouveau candidat"})]}),f&&e.jsxs("form",{onSubmit:A,className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-8 p-4 border rounded-lg bg-white shadow-inner",children:[e.jsx("div",{className:"col-span-2",children:e.jsx("h3",{className:"text-xl font-bold mb-4",children:a?"Modifier le candidat":"Ajouter un candidat"})}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-gray-700 text-sm font-bold mb-2",children:"Nom:"}),e.jsx("input",{type:"text",id:"name",name:"name",value:r.name,onChange:h,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"age",className:"block text-gray-700 text-sm font-bold mb-2",children:"Âge:"}),e.jsx("input",{type:"number",id:"age",name:"age",value:r.age,onChange:h,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"photo",className:"block text-gray-700 text-sm font-bold mb-2",children:"URL Photo:"}),e.jsx("input",{type:"text",id:"photo",name:"photo",value:r.photo,onChange:h,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"category",className:"block text-gray-700 text-sm font-bold mb-2",children:"Catégorie:"}),e.jsxs("select",{id:"category",name:"category",value:r.category,onChange:h,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",required:!0,children:[e.jsx("option",{value:"miss",children:"Miss"}),e.jsx("option",{value:"mister",children:"Mister"})]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("label",{htmlFor:"description",className:"block text-gray-700 text-sm font-bold mb-2",children:"Description:"}),e.jsx("textarea",{id:"description",name:"description",value:r.description,onChange:h,rows:3,className:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",required:!0})]}),e.jsx("div",{className:"col-span-2 flex justify-end",children:e.jsx("button",{type:"submit",className:"bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",children:a?"Mettre à jour":"Ajouter"})})]}),s&&e.jsx("p",{className:"text-center text-lg text-gray-600",children:"Chargement des candidats..."}),o&&e.jsxs("p",{className:"text-center text-lg text-red-600",children:["Erreur: ",o]}),!s&&!o&&d.length===0&&e.jsx("p",{className:"text-center text-lg text-gray-600",children:"Aucun candidat trouvé. Ajoutez-en un ci-dessus !"}),!s&&!o&&d.length>0&&e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full bg-white rounded-lg shadow-md",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200 text-gray-600 uppercase text-sm leading-normal",children:[e.jsx("th",{className:"py-3 px-6 text-left",children:"Nom"}),e.jsx("th",{className:"py-3 px-6 text-left",children:"Âge"}),e.jsx("th",{className:"py-3 px-6 text-left",children:"Catégorie"}),e.jsx("th",{className:"py-3 px-6 text-left",children:"Description"}),e.jsx("th",{className:"py-3 px-6 text-center",children:"Actions"})]})}),e.jsx("tbody",{className:"text-gray-600 text-sm font-light",children:d.map(t=>e.jsxs("tr",{className:"border-b border-gray-200 hover:bg-gray-100",children:[e.jsx("td",{className:"py-3 px-6 text-left whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"mr-2",children:e.jsx("img",{className:"w-8 h-8 rounded-full object-cover",src:t.photo,alt:t.name})}),e.jsx("span",{children:t.name})]})}),e.jsx("td",{className:"py-3 px-6 text-left",children:t.age}),e.jsx("td",{className:"py-3 px-6 text-left capitalize",children:t.category}),e.jsx("td",{className:"py-3 px-6 text-left max-w-xs overflow-hidden text-ellipsis",children:t.description}),e.jsx("td",{className:"py-3 px-6 text-center",children:e.jsxs("div",{className:"flex item-center justify-center space-x-4",children:[e.jsx("button",{onClick:()=>k(t),className:"w-6 h-6 transform hover:text-purple-500 hover:scale-110",children:e.jsx(M,{className:"w-full h-full"})}),e.jsx("button",{onClick:()=>E(t.id),className:"w-6 h-6 transform hover:text-red-500 hover:scale-110",children:e.jsx(R,{className:"w-full h-full"})})]})})]},t.id))})]})})]}),e.jsxs("div",{className:"mt-8 p-6 border rounded-lg bg-gray-50",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Statistiques de vote"}),s&&e.jsx("p",{className:"text-center text-lg text-gray-600",children:"Chargement des statistiques..."}),o&&e.jsxs("p",{className:"text-center text-lg text-red-600",children:["Erreur: ",o]}),!s&&!o&&d.length===0&&e.jsx("p",{className:"text-center text-lg text-gray-600",children:"Aucun candidat pour afficher les statistiques."}),!s&&!o&&d.length>0&&e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full bg-white rounded-lg shadow-md",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-200 text-gray-600 uppercase text-sm leading-normal",children:[e.jsx("th",{className:"py-3 px-6 text-left",children:"Nom"}),e.jsx("th",{className:"py-3 px-6 text-center",children:"Votes positifs"}),e.jsx("th",{className:"py-3 px-6 text-center",children:"Votes négatifs"}),e.jsx("th",{className:"py-3 px-6 text-center",children:"Total des votes"})]})}),e.jsx("tbody",{className:"text-gray-600 text-sm font-light",children:d.map(t=>{const c=u[t.id]||{upvotes:0,downvotes:0},x=c.upvotes-c.downvotes;return e.jsxs("tr",{className:"border-b border-gray-200 hover:bg-gray-100",children:[e.jsx("td",{className:"py-3 px-6 text-left whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"mr-2",children:e.jsx("img",{className:"w-8 h-8 rounded-full object-cover",src:t.photo,alt:t.name})}),e.jsx("span",{children:t.name})]})}),e.jsx("td",{className:"py-3 px-6 text-center text-green-600 font-medium",children:c.upvotes}),e.jsx("td",{className:"py-3 px-6 text-center text-red-600 font-medium",children:c.downvotes}),e.jsxs("td",{className:`py-3 px-6 text-center font-bold ${x>=0?"text-purple-600":"text-red-600"}`,children:[x>=0?"+":"",x]})]},t.id)})})]})})]})]})})};export{J as default};

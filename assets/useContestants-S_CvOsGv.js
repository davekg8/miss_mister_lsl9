import{a as u}from"./lucide-react-Cx0r66_4.js";import{d as v}from"./index-D_RnetDy.js";import{c as m,h as D,d as g,j as E,k as V,q as S,l as b}from"./firebase-JdEOCa9W.js";const q=()=>{const[i,d]=u.useState({});return u.useEffect(()=>{const a=m(v,"votes"),e=D(a,r=>{const t={};r.forEach(o=>{t[o.id]=o.data()}),d(t)});return()=>e()},[]),{voteData:i,vote:async(a,e)=>{const r=g(v,"votes",a);try{const t=await E(r);let o=0,l=0,s=null;if(t.exists()){const p=t.data();o=p.upvotes||0,l=p.downvotes||0,s=p.userVote||null}let c=o,n=l,f=null;s===e?(e==="up"?c-=1:n-=1,f=null):(s==="up"?c-=1:s==="down"&&(n-=1),e==="up"?c+=1:n+=1,f=e),await V(r,{upvotes:c,downvotes:n,userVote:f},{merge:!0})}catch(t){console.error("Error updating vote: ",t)}}}},x=()=>{const[i,d]=u.useState([]),[w,a]=u.useState(!0),[e,r]=u.useState(null);return u.useEffect(()=>{const t=m(v,"contestants"),o=S(t,b("name","asc")),l=D(o,s=>{const c=s.docs.map(n=>({id:n.id,...n.data()}));d(c),a(!1)},s=>{console.error("Error fetching contestants: ",s),r("Failed to load contestants."),a(!1)});return()=>l()},[]),{contestants:i,loading:w,error:e}};export{x as a,q as u};
